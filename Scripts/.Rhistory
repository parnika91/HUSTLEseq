umap <- integrated@reductions[["umap_cca"]]@cell.embeddings[,1:2]
integrated_df <- data.frame(integrated@meta.data[,c("orig.ident", "Donor_expt", "seurat_clusters", "HTO_classification", "pep.pool", "donor_pep.pool", "Barcode")], umap)
pheno_clono <- left_join(clonotype, integrated_df, by = "Barcode")
# clonotype gene markers
integrated_cl <- integrated
barcodes_to_keep <- pheno_clono %>%
filter(!is.na(Epitope.1)) %>%
pull(Barcode)
integrated_cl <- subset(integrated_cl, subset = (Barcode %in% barcodes_to_keep))
View(integrated_cl)
View(integrated_cl@meta.data)
View(pheno_clono)
View(integrated_cl)
View(integrated_cl@meta.data)
colnames(integrated_cl@meta.data)
integrated_cl <- subset(integrated_cl, subset = !is.na(Epitope.1))
barcodes_to_keep <- pheno_clono %>%
filter(!is.na(Epitope.1))
View(clonotype)
View(integrated_cl)
View(integrated_cl@meta.data)
View(imm.comb.markers)
View(clonotype)
integrated_cl.meta <- integrated_cl@meta.data %>%
left_join(., pheno_clono, by = "Barcode")
View(integrated_cl.meta)
rownames(integrated_cl.meta) <- rownames(integrated_cl@meta.data)
sim(integrated_cl.meta)
dim(integrated_cl.meta)
dim(integrated_cl@meta.data)
dim(pheno_clono)
length(barcodes_to_keep)
View(pheno_clono)
View(barcodes_to_keep)
dim(barcodes_to_keep)
barcodes_to_keep <- pheno_clono %>%
filter(!is.na(Epitope.1)) %>%
pull(Barcode)
View(integrated_cl)
integrated_cl <- subset(integrated_cl, subset = (Barcode %in% barcodes_to_keep))
# clonotype gene markers
integrated_cl <- integrated
integrated_cl <- subset(integrated_cl, subset = (Barcode %in% barcodes_to_keep))
View(integrated_cl)
integrated_cl@meta.data <- integrated_cl@meta.data %>%
mutate(cellID = rownames(.))
length((Barcode %in% barcodes_to_keep))
integrated@meta.data <- integrated@meta.data %>%
mutate(Barcode = rownames(.)) %>%
mutate(Barcode = gsub(".*_", "", Barcode))
umap <- integrated@reductions[["umap_cca"]]@cell.embeddings[,1:2]
integrated_df <- data.frame(integrated@meta.data[,c("orig.ident", "Donor_expt", "seurat_clusters", "HTO_classification", "pep.pool", "donor_pep.pool", "Barcode")], umap)
pheno_clono <- left_join(clonotype, integrated_df, by = "Barcode")
integrated <- readRDS("robjects/naive_merged_with_integrated_proliferated_L1_L2.rds")
clonotype <- read.csv2("../Data/HUSTLEseq_mapped_clean.csv")
integrated@meta.data <- integrated@meta.data %>%
mutate(Barcode = rownames(.)) %>%
mutate(Barcode = gsub(".*_", "", Barcode))
umap <- integrated@reductions[["umap_cca"]]@cell.embeddings[,1:2]
integrated_df <- data.frame(integrated@meta.data[,c("orig.ident", "Donor_expt", "seurat_clusters", "HTO_classification", "pep.pool", "donor_pep.pool", "Barcode")], umap)
pheno_clono <- left_join(clonotype, integrated_df, by = "Barcode")
# clonotype gene markers
integrated_cl <- integrated
barcodes_to_keep <- pheno_clono %>%
filter(!is.na(Epitope.1)) %>%
pull(Barcode)
integrated_cl <- subset(integrated_cl, subset = (Barcode %in% barcodes_to_keep))
integrated_cl@meta.data <- integrated_cl@meta.data %>%
mutate(cellID = rownames(.))
integrated_cl1 <- integrated_cl@meta.data %>%
left_join(., pheno_clono, by = "Barcode")
View(integrated_cl)
integrated_cl <- subset(integrated_cl, subset = (Barcode %in% integrated_cl1$Barcode))
View(integrated_cl)
integrated_cl@meta.data <- integrated_cl1
View(integrated_cl)
View(integrated_cl@meta.data)
integrated_cl@meta.data <- integrated_cl1 %>%
column_to_rownames(Barcode)
View(integrated_cl1)
integrated_cl@meta.data <- integrated_cl1 %>%
column_to_rownames(cellID)
integrated_cl@meta.data <- integrated_cl1 %>%
tibble::column_to_rownames(cellID)
# clonotype gene markers
integrated_cl <- integrated
# barcodes_to_keep <- pheno_clono %>%
#   filter(!is.na(Epitope.1)) %>%
#   pull(Barcode)
#
# integrated_cl <- subset(integrated_cl, subset = (Barcode %in% barcodes_to_keep))
#
integrated_cl@meta.data <- integrated_cl@meta.data %>%
mutate(cellID = rownames(.))
integrated_cl1 <- integrated_cl@meta.data %>%
left_join(., pheno_clono, by = "Barcode")
integrated_cl@meta.data <- integrated_cl1 %>%
tibble::column_to_rownames(cellID)
integrated_cl@meta.data <- integrated_cl1 %>%
tibble::column_to_rownames("cellID")
length(is.duplicated(rownames(integrated_cl@meta.data)))
length(duplicated(rownames(integrated_cl@meta.data)))
sum(duplicated(rownames(integrated_cl@meta.data)))
duplicated(rownames(integrated_cl@meta.data))
any(duplicated(rownames(integrated_cl@meta.data)))
View(integrated_cl)
View(integrated_cl@meta.data)
any(duplicated(rownames(integrated_cl1)))
sum(duplicated(integrated_cl1$cellID))
any(duplicated(rownames(integrated_cl1@cellID)))
any(duplicated(rownames(integrated_cl1$cellID)))
dup_ids <- integrated_cl1$cellID[duplicated(integrated_cl1$cellID)]
all(rownames(integrated_cl@meta.data) == colnames(integrated_cl))
View(pheno_clono)
pheno_clono <- left_join(clonotype, integrated_df, by = "Barcode") %>%
distinct(Barcode, .keep_all = T)
View(pheno_clono)
duplicated(pheno_clono$Barcode)
any(duplicated(pheno_clono$Barcode))
sum(duplicated(pheno_clono$Barcode))
pheno_clono <- left_join(clonotype, integrated_df, by = "Barcode")
sum(duplicated(pheno_clono$Barcode))
pheno_clono <- left_join(clonotype, integrated_df, by = "Barcode") %>%
distinct(Barcode, .keep_all = T)
# barcodes_to_keep <- pheno_clono %>%
#   filter(!is.na(Epitope.1)) %>%
#   pull(Barcode)
#
# integrated_cl <- subset(integrated_cl, subset = (Barcode %in% barcodes_to_keep))
#
integrated_cl@meta.data <- integrated_cl@meta.data %>%
mutate(cellID = rownames(.))
integrated_cl <- integrated
# barcodes_to_keep <- pheno_clono %>%
#   filter(!is.na(Epitope.1)) %>%
#   pull(Barcode)
#
# integrated_cl <- subset(integrated_cl, subset = (Barcode %in% barcodes_to_keep))
#
integrated_cl@meta.data <- integrated_cl@meta.data %>%
mutate(cellID = rownames(.))
sum(duplicated(integrated_cl@meta.data$cellID))
integrated_cl1 <- integrated_cl@meta.data %>%
left_join(., pheno_clono, by = "Barcode")
integrated_cl@meta.data <- integrated_cl1 %>%
tibble::column_to_rownames("cellID")
integrated_cl <- subset(integrated_cl, subset = (Barcode %in% integrated_cl1$Barcode))
all(rownames(integrated_cl@meta.data) == colnames(integrated_cl))
integrated_cl <- subset(integrated_cl, subset = !is.na(Epitope.1))
View(integrated_cl)
View(integrated_cl@meta.data)
clonotype_marker <- FindMarkers(integrated_cl, group.by = "Epitope.1", ident.1 = "68", ident.2 = "24", only.pos = T)
View(clonotype_marker)
clonotype_marker <- FindMarkers(integrated_cl,
group.by = "Epitope.1",
ident.1 = "68",
ident.2 = "24",
only.pos = F)
?FindMarkers()
clonotype_marker_68_24 <- FindMarkers(integrated_cl,
group.by = "Epitope.1",
ident.1 = "68",
ident.2 = "24",
only.pos = F)
View(clonotype_marker_68_24)
clonotype_marker_68_24 <- FindMarkers(integrated_cl,
group.by = "Epitope.1",
ident.1 = "68",
ident.2 = "24",
only.pos = F) %>%
mutate(gene = rownames(.))
View(clonotype_marker_68_24)
EnhancedVolcano(clonotype_marker_68_24,
lab = clonotype_marker_68_24$gene,
x = 'avg_log2FC',
y = 'p_val_adj',
ylab = bquote(~-Log[10]~ 'adjusted p-value'),
#pCutoff = 10e-5,
#FCcutoff = 1.5,
pointSize = 3.0,
#boxedLabels = F,
#labSize = NA,
col=c('grey48', 'grey48', 'grey48', 'red3'),
colAlpha = 0.7,
xlim = c(-3.5,3.5),
title = 'Epitope 24 <-- vs --> 68',
gridlines.major = FALSE,
gridlines.minor = FALSE)
clonotype_marker_68_28 <- FindMarkers(integrated_cl,
group.by = "Epitope.1",
ident.1 = "68",
ident.2 = "28",
only.pos = F) %>%
mutate(gene = rownames(.))
EnhancedVolcano(clonotype_marker_68_28,
lab = clonotype_marker_68_28$gene,
x = 'avg_log2FC',
y = 'p_val_adj',
ylab = bquote(~-Log[10]~ 'adjusted p-value'),
#pCutoff = 10e-5,
#FCcutoff = 1.5,
pointSize = 3.0,
#boxedLabels = F,
#labSize = NA,
col=c('grey48', 'grey48', 'grey48', 'red3'),
colAlpha = 0.7,
xlim = c(-3.5,3.5),
title = 'Epitope 28 <-- vs --> 68',
gridlines.major = FALSE,
gridlines.minor = FALSE)
clonotype_marker_68_38 <- FindMarkers(integrated_cl,
group.by = "Epitope.1",
ident.1 = "68",
ident.2 = "38",
only.pos = F) %>%
mutate(gene = rownames(.))
EnhancedVolcano(clonotype_marker_68_38,
lab = clonotype_marker_68_38$gene,
x = 'avg_log2FC',
y = 'p_val_adj',
ylab = bquote(~-Log[10]~ 'adjusted p-value'),
#pCutoff = 10e-5,
#FCcutoff = 1.5,
pointSize = 3.0,
#boxedLabels = F,
#labSize = NA,
col=c('grey48', 'grey48', 'grey48', 'red3'),
colAlpha = 0.7,
xlim = c(-3.5,3.5),
title = 'Epitope 38 <-- vs --> 68',
gridlines.major = FALSE,
gridlines.minor = FALSE)
clonotype_marker_68_10 <- FindMarkers(integrated_cl,
group.by = "Epitope.1",
ident.1 = "68",
ident.2 = "10",
only.pos = F) %>%
mutate(gene = rownames(.))
EnhancedVolcano(clonotype_marker_68_10,
lab = clonotype_marker_68_10$gene,
x = 'avg_log2FC',
y = 'p_val_adj',
ylab = bquote(~-Log[10]~ 'adjusted p-value'),
#pCutoff = 10e-5,
#FCcutoff = 1.5,
pointSize = 3.0,
#boxedLabels = F,
#labSize = NA,
col=c('grey48', 'grey48', 'grey48', 'red3'),
colAlpha = 0.7,
xlim = c(-3.5,3.5),
title = 'Epitope 10 <-- vs --> 68',
gridlines.major = FALSE,
gridlines.minor = FALSE)
library(Seurat)
library(patchwork)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(reshape2)
library(broom)
library(stringr)
library(ggplot2)
library(cowplot)
library(RColorBrewer)
library(data.table)
library(DropletUtils)
# devtools::install_github("satijalab/seurat", "seurat5")
# devtools::install_github("satijalab/seurat-data", "seurat5")
# BiocManager::install("DirichletMultinomial")
# install.packages("hdf5r")
# remotes::install_github("mojaveazure/seurat-disk")
# BiocManager::install("TFBSTools")
# remotes::install_github('satijalab/azimuth', ref = 'master')
library(Azimuth)
library(plyr)
library(Seurat)
library(patchwork)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(reshape2)
library(broom)
library(stringr)
library(ggplot2)
library(cowplot)
library(RColorBrewer)
library(data.table)
library(DropletUtils)
# devtools::install_github("satijalab/seurat", "seurat5")
# devtools::install_github("satijalab/seurat-data", "seurat5")
# BiocManager::install("DirichletMultinomial")
# install.packages("hdf5r")
# remotes::install_github("mojaveazure/seurat-disk")
# BiocManager::install("TFBSTools")
# remotes::install_github('satijalab/azimuth', ref = 'master')
library(Azimuth)
# group together the SPZ conditions and the RBC conditions
integrated@meta.data <- integrated@meta.data %>%
mutate(Condition = case_when(
orig.ident %in% "D13_D33_D45_D47_CD4_Naive" ~ "Naive",
.default = "Proliferated"
))
integrated <- readRDS("robjects/naive_merged_with_integrated_proliferated_L1_L2.rds")
# group together the SPZ conditions and the RBC conditions
integrated@meta.data <- integrated@meta.data %>%
mutate(Condition = case_when(
orig.ident %in% "D13_D33_D45_D47_CD4_Naive" ~ "Naive",
.default = "Proliferated"
))
table(integrated$Condition)
# Naive Proliferated
# 1300         8825
table(integrated$Condition, integrated$Donor_expt)
#               D13  D33  D45  D47
# Naive         265  320  443  272
# Proliferated  624 1205  178 6818
# first get average expression
pseudo_integrated <- AggregateExpression(
integrated,
assays = "RNA",
return.seurat = T,
group.by = c("Condition", "Donor_expt"))
tail(Cells(pseudo_integrated))
# then, pseudobulk
Idents(pseudo_integrated) <- "Condition"
pseudo_integrated.de <- FindMarkers(
object = pseudo_integrated,
ident.1 = "Proliferated",
ident.2 = "Naive",
test.use = "DESeq2",
only.pos = F)
pseudo_integrated.de <- pseudo_integrated.de %>%
rownames_to_column("gene")
write.table(pseudo_integrated.de,
"Proliferated_up_Naive_down_DEG.txt",
quote = F,
row.names = F)
View(pseudo_integrated.de)
# which upregulated gene in proliferated in present in every cell above a certain transcript abundance threshold?
naive_cells <- WhichCells(integrated, ident = "Naive")
# which upregulated gene in proliferated in present in every cell above a certain transcript abundance threshold?
Idents(integrated) <- "Condition"
naive_cells <- WhichCells(integrated, ident = "Naive")
prolif_cells <- WhichCells(integrated, ident = "Proliferated")
expr <- GetAssayData(integrated, slot = "data")  # normalized expression (log-normalized counts)
expr_naive <- expr[, naive_cells]
expr_prolif <- expr[, prolif_cells]
# Genes expressed in ALL proliferated cells
genes_all_prolif <- rownames(expr_prolif)[rowSums(expr_prolif > 0) == ncol(expr_prolif)]
# Genes expressed in ZERO naive cells
genes_none_naive <- rownames(expr_naive)[rowSums(expr_naive > 0) == 0]
# Intersection = genes only in proliferated, never in naive
marker_genes <- intersect(genes_all_prolif, genes_none_naive)
View(expr_prolif)
prop_prolif <- rowSums(expr_prolif > 0) / ncol(expr_prolif)
prop_naive  <- rowSums(expr_naive  > 0) / ncol(expr_naive)
marker_genes <- rownames(expr)[prop_prolif >= 0.9 & prop_naive == 0]
View(expr_naive)
expr_naive
prop_prolif
max(prop_prolif)
head(order(prop_prolif))
head(sort(prop_prolif))
head(sort(-prop_prolif))
head(sort(prop_prolif, decreasing = T))
prolif_rowSums <- rowSums(expr_prolif)
naive_rowSums <- rowSums(expr_naive)
identical(names(naive_rowSums), names(prolif_rowSums))
prop_prolif >= 0.9
marker_genes <- rownames(expr)[prop_prolif >= 0.85 & prop_naive == 0]
identical(names(prop_prolif), rownames(expr))
marker_genes <- rownames(expr)[prop_prolif >= 0.8 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.7 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.6 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.5 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.4 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.3 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.2 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.1 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.4 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.3 & prop_naive == 0]
FeaturePlot(integrated, reduction = "umap_cca", features = "PCLAF")
# stratify based on PCLAF plot above and then find markers again
integrated@meta.data <- integrated@meta.data %>%
mutate(Cluster_stratify = case_when(
orig.ident %in% "D13_D33_D45_D47_CD4_Naive" ~ "Naive",
seurat_clusters %in% c("0", "5") ~ "Prolif_naive",
.default = "Proliferated"
))
proliferated_cells <- WhichCells(integrated, ident = "Proliferated")
Idents(integrated) <- "Cluster_stratify"
naive_cells <- WhichCells(integrated, ident = "Naive")
prolif_naive_cells <- WhichCells(integrated, ident = "Prolif_naive")
proliferated_cells <- WhichCells(integrated, ident = "Proliferated")
expr <- GetAssayData(integrated, slot = "data")  # normalized expression (log-normalized counts)
expr_naive <- expr[, naive_cells]
expr_prolif_naive <- expr[, prolif_naive_cells]
expr_prolif <- expr[, proliferated_cells]
prolif_naive_rowSums <- rowSums(expr_prolif_naive)
prop_prolif_naive <- rowSums(expr_prolif_naive > 0) / ncol(expr_prolif_naive)
prop_prolif <- rowSums(expr_prolif > 0) / ncol(expr_prolif)
prop_prolif_naive <- rowSums(expr_prolif_naive > 0) / ncol(expr_prolif_naive)
prop_naive  <- rowSums(expr_naive  > 0) / ncol(expr_naive)
marker_genes <- rownames(expr)[prop_prolif >= 0.9 | prop_prolif_naive >= 0.5 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.9 | prop_prolif_naive >= 0.7 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.9 | prop_prolif_naive >= 0.8 & prop_naive == 0]
marker_genes <- rownames(expr)[prop_prolif >= 0.9 | prop_prolif_naive >= 0.9 & prop_naive == 0]
hist(prop_prolif)
hist(prop_prolif_naive)
hist(naive)
hist(prop_naive)
View(as.data.frame(marker_genes))
FeaturePlot(integrated, reduction = "umap_cca", features = "CD74")
FeaturePlot(integrated, reduction = "umap_cca", features = "CD74")
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.9) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.7) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.6) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.5) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.4) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.3) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.2) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.9 | prop_prolif_naive >= 0.1) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.6 | prop_prolif_naive >= 0.7) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.5 | prop_prolif_naive >= 0.7) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.5 | prop_prolif_naive >= 0.7) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.7) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.6) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.5) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.4) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.3) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.2) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.1) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.4) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.5) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.6) & prop_naive == 0]
marker_genes <- rownames(expr)[(prop_prolif >= 0.4 | prop_prolif_naive >= 0.7) & prop_naive == 0]
pseudo_integrated <- AggregateExpression(
integrated,
assays = "RNA",
return.seurat = T,
group.by = c("Cluster_stratify", "Donor_expt"))
tail(Cells(pseudo_integrated))
pseudo_integrated.de <- FindMarkers(
object = pseudo_integrated,
ident.1 = "Proliferated",
ident.2 = "Prolif_naive",
test.use = "DESeq2",
only.pos = F)
# then, pseudobulk
Idents(pseudo_integrated) <- "Cluster_stratify"
pseudo_integrated.de <- FindMarkers(
object = pseudo_integrated,
ident.1 = "Proliferated",
ident.2 = "Prolif_naive",
test.use = "DESeq2",
only.pos = F)
pseudo_integrated.de <- FindMarkers(
object = pseudo_integrated,
ident.1 = "Proliferated",
ident.2 = "Prolif-naive",
test.use = "DESeq2",
only.pos = F)
pseudo_integrated.de <- pseudo_integrated.de %>%
rownames_to_column("gene")
View(pseudo_integrated.de)
FeaturePlot(integrated, reduction = "umap_cca", features = "MK167")
FeaturePlot(integrated, reduction = "umap_cca", features = "MKI67")
FeaturePlot(integrated, reduction = "umap_cca", features = "TUBA1B")
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive == 2]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive == 0.2]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive == 0.3]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive == 0.4]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive <= 0.4]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive <= 0.2]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive <= 0.1]
FeaturePlot(integrated, reduction = "umap_cca", features = "TUBA1B")
FeaturePlot(integrated, reduction = "umap_cca", features = "NKG7")
DimPlot(integrated, reduction = "umap_cca", group_by = "Cluster_stratify")
DimPlot(integrated, reduction = "umap_cca", group.by = "Cluster_stratify")
marker_genes
marker_genes <- rownames(expr)[(prop_prolif >= 0.6 | prop_prolif_naive >= 0.6) & prop_naive <= 0.05]
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive <= 0.05]
FeaturePlot(integrated, reduction = "umap_cca", features = "CD69")
FeaturePlot(integrated, reduction = "umap_cca", features = "CD137")
FeaturePlot(integrated, reduction = "umap_cca", features = "CD107a")
FeaturePlot(integrated, reduction = "umap_cca", features = "LAMP1")
marker_genes
marker_genes <- rownames(expr)[(prop_prolif >= 0.7 | prop_prolif_naive >= 0.7) & prop_naive <= 0.1]
marker_genes
marker_genes <- rownames(expr)[(prop_prolif >= 0.6 | prop_prolif_naive >= 0.6) & prop_naive <= 0.1]
marker_genes
FeaturePlot(integrated, reduction = "umap_cca", features = "EFHD2")
FeaturePlot(integrated, reduction = "umap_cca", features = "STMN1")
marker_genes <- rownames(expr)[(prop_prolif <= 0.1 | prop_prolif_naive <= 0.1) & prop_naive >= 0.6]
marker_genes
FeaturePlot(integrated, reduction = "umap_cca", features = "IL7R")
marker_genes <- rownames(expr)[(prop_prolif <= 0.15 | prop_prolif_naive <= 0.15) & prop_naive >= 0.6]
marker_genes <- rownames(expr)[(prop_prolif <= 0.2 | prop_prolif_naive <= 0.2) & prop_naive >= 0.6]
FeaturePlot(integrated, reduction = "umap_cca", features = "IL7R")
FeaturePlot(integrated, reduction = "umap_cca", features = "STMN1")
FeaturePlot(integrated, reduction = "umap_cca", features = "PYCARD")
FeaturePlot(integrated, reduction = "umap_cca", features = "UCP2")
FeaturePlot(integrated, reduction = "umap_cca", features = "SRSF2")
FeaturePlot(integrated, reduction = "umap_cca", features = "SNRPD1")
FeaturePlot(integrated, reduction = "umap_cca", features = "HLA-DRA")
FeaturePlot(integrated, reduction = "umap_cca", features = "HLA-DRB1")
FeaturePlot(integrated, reduction = "umap_cca", features = "HLA-DRA")
FeaturePlot(integrated, reduction = "umap_cca", features = "IFNG")
